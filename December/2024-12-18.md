## 📆 2024-12-18

### 🔔 학습 목표

- [네트워크] 전송 계층 TCP와 UDP 정리

### 🚀 Today I Learned

#### 주제 1: TCP와 UDP의 목적과 특징

- 네트워크 상에서 호스트(컴퓨터, 스마트폰 등)들은 TCP/UDP 프로토콜을 통해 패킷을 주고 받는다. 그리고 그 패킷들의 최종 송수신 대상은 호스트가 아니라 <b>호스트가 실행하는 프로세스</b>이다.
- IP 주소는 네트워크 상에서 호스트를 식별할 수 있는 주소이다. 그리고 포트 번호는 호스트에서 실행되고 있는 프로세스들을 식별할 수 있는 번호이다. 그래서 TCP,UDP의 헤더를 보면 송수신지 포트번호가 있는 걸 확인할 수 있다.
- 포트 번호 0~1023은 잘 알려진 포트(well known port), 1024 ~ 49151 은 등록된 포트, 49152 ~ 66535 는 동적 포트이다.
  1. 잘 알려진 포트는 범용적으로 사용되는 프로토콜들을 위한 포트 번호이다.
  2. 등록된 포트는 덜 범용적이지만, 흔하게 사용되는 애플리케이션 프로토콜을 위한 포트번호이다. 주로 서버 개발할 때 많이 사용되는 포트 번호이기도 하다.
  3. 동적 포트는 비교적 자유롭게 사용 가능한 포트 번호이고, 클라이언트로서 동작하는 프로그램에 할당되는 경우가 많다. 윈도우에서 리소스 매니저를 키면 네트워크 탭에서 현재 실행 중인 프로세스들의 포트 번호들을 확인할 수 있다.

#### 주제 2: NAT와 NAPT

- 공인 IP 주소와 사설 IP 주소의 차이
  - 공인 IP 주소는 인터넷 서비스 제공업체(ISP)에서 제공하며, 전 세계적으로 고유한 주소, 네트워크 외부(인터넷) 에서 접근 가능능
  - 사설 IP 주소는 로컬 네트워크(예: 가정, 회사 네트워크) 내에서 사용, 로컬 네트워크 내에서만 통신하는 장치들(예: PC, 스마트폰, 프린터)에 사용
- 네트워크 내부에서 사용되는 사설 IP 주소를 가진 호스트가 네트워크 외부의 호스와 패킷을 주고받기 위해서는 공인 IP 주소와 사설 IP 주소 간 변환이 필요한데, 이 때 사용되는 기술을 <b>NAT(Network Address Translation)</b>라고 한다.
- 요즘에는 대부분의 공유기와 라우터에 NAT 기능이 내장되어 있다.
- 네트워크 내부(호스트) ---(사설 IP 주소를 공인 IP 주소로 변환)---> 라우터 ---(공인 IP 주소를 사설설 IP 주소로 변환)---> 네트워크 외부(호스트)
- 옛날에는 사설 IP 주소와 공인 IP 주소가 일대일 대응되어 변환되었지만, 이제는 사설 IP 주소가 공인 IP 주소보다 훨씬 많으므로, 공인 IP 주소에 포트 번호를 추가로 사용해 IP를 변환하는데, 이를 <b>NAPT(Network Address Port Translation)</b>라고 한다. 이를 통해 공인 IP 주소의 부족 문제를 개선하고 있다.

#### 주제 3: (비)신뢰성과 (비)연결형 보장

- TCP는 신뢰할 수 있는 프로토콜이자 연결형 프로토콜, UDP는 신뢰할 수 없는 프로토콜이자 비연결형 프로토콜이다.
- TCP는 신뢰할 수 있는 통신으로 상태 관리, 흐름 제어, 오류 제어, 혼잡 제어 등 여러 가지 기능을 제공하고, 연결형 통신으로 패킷을 주고받기 전 연결 수립 -> 패킷 통신 -> 종료 과정을 가진다. UDP는 그런 거 없다.
- 그러다보니 당연히 패킷의 유실 없는 정확한 통신은 TCP가 더 좋고, 빠른 송수신 속도는 UDP가 더 좋다.
- UDP 헤더에는 송신지 포트, 수신지 포트, 패킷 길이를 저장하는 길이 필드, 송수신 과정에서의 데이터그램 훼손 여부를 알 수 있는 체크섬 필드가 있다.
- TCP 헤더에는 UDP 헤더보다 많은 필드가 있다. UDP 헤더의 필드를 포함해서 순서 번호 필드, 확인 응답 번호 필드, 일부 제어 필드(ACK 플래그, SYN 플래그, FIN 플래그 등)
- 호스트 A에서 순서 번호(seq)를 보내고 1을 더해서 그에 대한 응답으로 확인 응답 번호(ACK)를 호스트 B에서 보내는 방식이 기본적인 통신 방식이다.
- ACK: 세그먼트의 승인을 나타내기 위한 비트, SYN: 연결을 수립하기 위한 비트, FIN: 연결을 종료하기 위한 비트

### 📰 참고 자료 및 링크

- 이것이 컴퓨터 과학이다 - 강민철
